{"changed":true,"filter":false,"title":"Untitled","tooltip":"/js/third-party/threejs/Untitled","value":"\n\nTHREE.FirstPersonControls = function ( object, domElement ) {\n\n\tthis.object = object;\n\tthis.target = new THREE.Vector3( 0, 0, 0 );\n\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\n\n\tthis.movementSpeed = 1.0;\n\tthis.lookSpeed = 0.005;\n\n\tthis.noFly = false;\n\tthis.lookVertical = true;\n\tthis.autoForward = false;\n\n\tthis.activeLook = true;\n\n\tthis.heightSpeed = false;\n\tthis.heightCoef = 1.0;\n\tthis.heightMin = 0.0;\n\n\tthis.constrainVertical = false;\n\tthis.verticalMin = 0;\n\tthis.verticalMax = Math.PI;\n\n\tthis.autoSpeedFactor = 0.0;\n\n\tthis.mouseX = 0;\n\tthis.mouseY = 0;\n\n\tthis.lat = 0;\n\tthis.lon = 0;\n\tthis.phi = 0;\n\tthis.theta = 0;\n\n\tthis.moveForward = false;\n\tthis.moveBackward = false;\n\tthis.moveLeft = false;\n\tthis.moveRight = false;\n\tthis.freeze = false;\n\n\tthis.mouseDragOn = false;\n\n\tif ( this.domElement === document ) {\n\n\t\tthis.viewHalfX = window.innerWidth / 2;\n\t\tthis.viewHalfY = window.innerHeight / 2;\n\n\t} else {\n\n\t\tthis.viewHalfX = this.domElement.offsetWidth / 2;\n\t\tthis.viewHalfY = this.domElement.offsetHeight / 2;\n\t\tthis.domElement.setAttribute( 'tabindex', -1 );\n\n\t}\n\n\tthis.onMouseDown = function ( event ) {\n\n\t\tif ( this.domElement !== document ) {\n\n\t\t\tthis.domElement.focus();\n\n\t\t}\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( this.activeLook ) {\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0: this.moveForward = true; break;\n\t\t\t\tcase 2: this.moveBackward = true; break;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.mouseDragOn = true;\n\n\t};\n\n\tthis.onMouseUp = function ( event ) {\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( this.activeLook ) {\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0: this.moveForward = false; break;\n\t\t\t\tcase 2: this.moveBackward = false; break;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.mouseDragOn = false;\n\n\t};\n\n\tthis.onMouseMove = function ( event ) {\n\n\t\tif ( this.domElement === document ) {\n\n\t\t\tthis.mouseX = event.pageX - this.viewHalfX;\n\t\t\tthis.mouseY = event.pageY - this.viewHalfY;\n\n\t\t} else {\n\n\t\t\tthis.mouseX = event.pageX - this.domElement.offsetLeft - this.viewHalfX;\n\t\t\tthis.mouseY = event.pageY - this.domElement.offsetTop - this.viewHalfY;\n\n\t\t}\n\n\t};\n\n\tthis.onKeyDown = function ( event ) {\n\n\t\tswitch( event.keyCode ) {\n\n\t\t\tcase 38: /*up*/\n\t\t\tcase 87: /*W*/ this.moveForward = true; break;\n\n\t\t\tcase 37: /*left*/\n\t\t\tcase 65: /*A*/ this.moveLeft = true; break;\n\n\t\t\tcase 40: /*down*/\n\t\t\tcase 83: /*S*/ this.moveBackward = true; break;\n\n\t\t\tcase 39: /*right*/\n\t\t\tcase 68: /*D*/ this.moveRight = true; break;\n\n\t\t\tcase 82: /*R*/ this.moveUp = true; break;\n\t\t\tcase 70: /*F*/ this.moveDown = true; break;\n\n\t\t\tcase 81: /*Q*/ this.freeze = !this.freeze; break;\n\n\t\t}\n\n\t};\n\n\tthis.onKeyUp = function ( event ) {\n\n\t\tswitch( event.keyCode ) {\n\n\t\t\tcase 38: /*up*/\n\t\t\tcase 87: /*W*/ this.moveForward = false; break;\n\n\t\t\tcase 37: /*left*/\n\t\t\tcase 65: /*A*/ this.moveLeft = false; break;\n\n\t\t\tcase 40: /*down*/\n\t\t\tcase 83: /*S*/ this.moveBackward = false; break;\n\n\t\t\tcase 39: /*right*/\n\t\t\tcase 68: /*D*/ this.moveRight = false; break;\n\n\t\t\tcase 82: /*R*/ this.moveUp = false; break;\n\t\t\tcase 70: /*F*/ this.moveDown = false; break;\n\n\t\t}\n\n\t};\n\n\tthis.update = function( delta ) {\n\t\tvar actualMoveSpeed = 0;\n\t\tif ( !this.freeze ) {\n\n\t\t\tif ( this.heightSpeed ) {\n\n\t\t\t\tvar y = THREE.Math.clamp( this.object.position.y, this.heightMin, this.heightMax );\n\t\t\t\tvar heightDelta = y - this.heightMin;\n\n\t\t\t\tthis.autoSpeedFactor = delta * ( heightDelta * this.heightCoef );\n\n\t\t\t} else {\n\n\t\t\t\tthis.autoSpeedFactor = 0.0;\n\n\t\t\t}\n\n\t\t\tactualMoveSpeed = delta * this.movementSpeed;\n\n\t\t\tif ( this.moveForward || ( this.autoForward && !this.moveBackward ) ) this.object.translateZ( - ( actualMoveSpeed + this.autoSpeedFactor ) );\n\t\t\tif ( this.moveBackward ) this.object.translateZ( actualMoveSpeed );\n\n\t\t\tif ( this.moveLeft ) this.object.translateX( - actualMoveSpeed );\n\t\t\tif ( this.moveRight ) this.object.translateX( actualMoveSpeed );\n\n\t\t\tif ( this.moveUp ) this.object.translateY( actualMoveSpeed );\n\t\t\tif ( this.moveDown ) this.object.translateY( - actualMoveSpeed );\n\n\t\t\tvar actualLookSpeed = delta * this.lookSpeed;\n\n\t\t\tif ( !this.activeLook ) {\n\n\t\t\t\tactualLookSpeed = 0;\n\n\t\t\t}\n\n\t\t\tthis.lon += this.mouseX * actualLookSpeed;\n\t\t\tif( this.lookVertical ) this.lat -= this.mouseY * actualLookSpeed;\n\n\t\t\tthis.lat = Math.max( - 85, Math.min( 85, this.lat ) );\n\t\t\tthis.phi = ( 90 - this.lat ) * Math.PI / 180;\n\t\t\tthis.theta = this.lon * Math.PI / 180;\n\n\t\t\tvar targetPosition = this.target,\n\t\t\t\tposition = this.object.position;\n\n\t\t\ttargetPosition.x = position.x + 100 * Math.sin( this.phi ) * Math.cos( this.theta );\n\t\t\ttargetPosition.y = position.y + 100 * Math.cos( this.phi );\n\t\t\ttargetPosition.z = position.z + 100 * Math.sin( this.phi ) * Math.sin( this.theta );\n\n\t\t}\n\n\t\tvar verticalLookRatio = 1;\n\n\t\tif ( this.constrainVertical ) {\n\n\t\t\tverticalLookRatio = Math.PI / ( this.verticalMax - this.verticalMin );\n\n\t\t}\n\n\t\tthis.lon += this.mouseX * actualLookSpeed;\n\t\tif( this.lookVertical ) this.lat -= this.mouseY * actualLookSpeed * verticalLookRatio;\n\n\t\tthis.lat = Math.max( - 85, Math.min( 85, this.lat ) );\n\t\tthis.phi = ( 90 - this.lat ) * Math.PI / 180;\n\n\t\tthis.theta = this.lon * Math.PI / 180;\n\n\t\tif ( this.constrainVertical ) {\n\n\t\t\tthis.phi = THREE.Math.mapLinear( this.phi, 0, Math.PI, this.verticalMin, this.verticalMax );\n\n\t\t}\n\n\t\tvar targetPosition = this.target,\n\t\t\tposition = this.object.position;\n\n\t\ttargetPosition.x = position.x + 100 * Math.sin( this.phi ) * Math.cos( this.theta );\n\t\ttargetPosition.y = position.y + 100 * Math.cos( this.phi );\n\t\ttargetPosition.z = position.z + 100 * Math.sin( this.phi ) * Math.sin( this.theta );\n\n\t\tthis.object.lookAt( targetPosition );\n\n\t};\n\n\n\tthis.domElement.addEventListener( 'contextmenu', function ( event ) { event.preventDefault(); }, false );\n\n\tthis.domElement.addEventListener( 'mousemove', bind( this, this.onMouseMove ), false );\n\tthis.domElement.addEventListener( 'mousedown', bind( this, this.onMouseDown ), false );\n\tthis.domElement.addEventListener( 'mouseup', bind( this, this.onMouseUp ), false );\n\tthis.domElement.addEventListener( 'keydown', bind( this, this.onKeyDown ), false );\n\tthis.domElement.addEventListener( 'keyup', bind( this, this.onKeyUp ), false );\n\n\tfunction bind( scope, fn ) {\n\n\t\treturn function () {\n\n\t\t\tfn.apply( scope, arguments );\n\n\t\t};\n\n\t};\n\n};","undoManager":{"mark":-1,"position":7,"stack":[[{"group":"doc","deltas":[{"start":{"row":276,"column":5},"end":{"row":276,"column":6},"action":"remove","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":276,"column":4},"end":{"row":276,"column":5},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":276,"column":3},"end":{"row":276,"column":4},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":276,"column":2},"end":{"row":276,"column":3},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":276,"column":1},"end":{"row":276,"column":2},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":276,"column":0},"end":{"row":276,"column":1},"action":"remove","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":275,"column":2},"end":{"row":276,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":4,"column":3},"action":"remove","lines":["/**"," * @author mrdoob / http://mrdoob.com/"," * @author alteredq / http://alteredqualia.com/"," * @author paulirish / http://paulirish.com/"," */"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":2,"column":6},"end":{"row":2,"column":25},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1421724914000}